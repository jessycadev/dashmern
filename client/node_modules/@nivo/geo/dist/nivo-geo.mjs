import{memo as o,useMemo as e,useCallback as t,Fragment as r,useRef as i,useEffect as n}from"react";import{useTheme as a,guessQuantizeColorScale as l,useDimensions as u,SvgWrapper as d,withContainer as c,ResponsiveWrapper as f,getRelativeCursor as h,bindDefs as v}from"@nivo/core";import{useTooltip as s,BasicTooltip as g}from"@nivo/tooltip";import{jsx as p}from"react/jsx-runtime";import m from"lodash/isFunction.js";import C from"lodash/get.js";import{format as b}from"d3-format";import{geoAzimuthalEqualArea as j,geoAzimuthalEquidistant as w,geoGnomonic as W,geoOrthographic as y,geoStereographic as M,geoEqualEarth as k,geoEquirectangular as T,geoMercator as F,geoTransverseMercator as S,geoNaturalEarth1 as E,geoPath as L,geoGraticule as R,geoContains as B}from"d3-geo";import{useInheritedColor as x}from"@nivo/colors";import{useQuantizeColorScaleLegendData as P,BoxLegendSvg as G,renderLegendToCanvas as H}from"@nivo/legends";var I=o((function(o){var e=o.path,t=o.graticule,r=o.lineWidth,i=o.lineColor;return p("path",{fill:"none",strokeWidth:r,stroke:i,d:e(t())})})),q=o((function(o){var e,t=o.feature,r=o.path,i=o.fillColor,n=o.borderWidth,a=o.borderColor,l=o.onClick,u=o.onMouseEnter,d=o.onMouseMove,c=o.onMouseLeave;return p("path",{fill:null!=(e=null==t?void 0:t.fill)?e:i,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:r(t),onMouseEnter:function(o){return u(t,o)},onMouseMove:function(o){return d(t,o)},onMouseLeave:function(o){return c(t,o)},onClick:function(o){return l(t,o)}},t.id)}));function O(){return O=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},O.apply(this,arguments)}var D={azimuthalEqualArea:j,azimuthalEquidistant:w,gnomonic:W,orthographic:y,stereographic:M,equalEarth:k,equirectangular:T,mercator:F,transverseMercator:S,naturalEarth1:E},z=function(o){var t=o.width,r=o.height,i=o.projectionType,n=o.projectionScale,l=o.projectionTranslation,u=o.projectionRotation,d=o.fillColor,c=o.borderWidth,f=o.borderColor,h=e((function(){return D[i]().scale(n).translate([t*l[0],r*l[1]]).rotate(u)}),[t,r,i,n,l[0],l[1],u[0],u[1],u[2]]),v=e((function(){return L(h)}),[h]),s=e((function(){return R()})),g=a(),p=e((function(){return"function"==typeof c?c:function(){return c}}),[c]),m=x(f,g),C=e((function(){return"function"==typeof d?d:function(){return d}}),[d]);return{projection:h,path:v,graticule:s,getBorderWidth:p,getBorderColor:m,getFillColor:C}},K=function(o){var t=o.features,r=o.data,i=o.match,n=o.label,a=o.value,u=o.valueFormat,d=o.colors,c=o.unknownColor,f=o.domain,h=e((function(){return m(i)?i:function(o,e){var t=C(o,i),r=C(e,i);return t&&t===r}}),[i]),v=e((function(){return m(n)?n:function(o){return C(o,n)}}),[n]),s=e((function(){return m(a)?a:function(o){return C(o,a)}}),[a]),g=e((function(){return void 0===u?function(o){return o}:m(u)?u:b(u)}),[u]),p=e((function(){return l(d).domain(f)}),[d,f]),j=e((function(){return function(o){return void 0===o.value?c:p(o.value)}}),[p,c]),w=e((function(){return t.map((function(o){var e=r.find((function(e){return h(o,e)})),t=s(e);if(e){var i=O({},o,{data:e,value:t,formattedValue:g(t)});return i.color=j(i),i.label=v(i),i}return o}))}),[t,r,h,s,g,j]),W=P({scale:p,valueFormat:g});return{colorScale:p,getFillColor:j,boundFeatures:w,valueFormatter:g,legendData:W}},V=c(o((function(o){var e=o.width,i=o.height,n=o.margin,l=o.features,c=o.layers,f=void 0===c?["graticule","features"]:c,h=o.projectionType,v=void 0===h?"mercator":h,g=o.projectionScale,m=void 0===g?100:g,C=o.projectionTranslation,b=void 0===C?[.5,.5]:C,j=o.projectionRotation,w=void 0===j?[0,0,0]:j,W=o.fillColor,y=void 0===W?"#dddddd":W,M=o.borderWidth,k=void 0===M?0:M,T=o.borderColor,F=void 0===T?"#000000":T,S=o.enableGraticule,E=void 0!==S&&S,L=o.graticuleLineWidth,R=void 0===L?.5:L,B=o.graticuleLineColor,x=void 0===B?"#999999":B,P=o.isInteractive,G=void 0===P||P,H=o.onClick,O=void 0===H?function(){}:H,D=o.tooltip,K=o.role,V=void 0===K?"img":K,A=u(e,i,n),J=A.margin,N=A.outerWidth,Q=A.outerHeight,U=z({width:e,height:i,projectionType:v,projectionScale:m,projectionTranslation:b,projectionRotation:w,fillColor:y,borderWidth:k,borderColor:F}),X=U.graticule,Y=U.path,Z=U.getFillColor,$=U.getBorderWidth,_=U.getBorderColor,oo=a(),eo=s(),to=eo.showTooltipFromEvent,ro=eo.hideTooltip,io=t((function(o,e){return G&&O&&O(o,e)}),[G,O]),no=t((function(o,e){return G&&D&&to(p(D,{feature:o}),e)}),[G,to,D]),ao=t((function(o,e){return G&&D&&to(p(D,{feature:o}),e)}),[G,to,D]),lo=t((function(){return G&&ro()}),[G,ro]);return p(d,{width:N,height:Q,margin:J,theme:oo,role:V,children:f.map((function(e,t){return"graticule"===e?!0!==E?null:p(I,{path:Y,graticule:X,lineWidth:R,lineColor:x},"graticule"):"features"===e?p(r,{children:l.map((function(o){return p(q,{feature:o,path:Y,fillColor:Z(o),borderWidth:$(o),borderColor:_(o),onMouseEnter:no,onMouseMove:ao,onMouseLeave:lo,onClick:io},o.id)}))},"features"):p(r,{children:e(o)},t)}))})}))),A=function(o){return p(f,{children:function(e){var t=e.width,r=e.height;return p(V,O({width:t,height:r},o))}})},J=function(o,e,t,r){var i=h(e,o),n=i[0],a=i[1];return t.find((function(o){return B(o,r.invert([n,a]))}))},N=c(o((function(o){var e=o.width,r=o.height,l=o.margin,d=o.pixelRatio,c=void 0===d?"undefined"!=typeof window&&window.devicePixelRatio||1:d,f=o.features,h=o.layers,v=o.projectionType,g=void 0===v?"mercator":v,m=o.projectionScale,C=void 0===m?100:m,b=o.projectionTranslation,j=void 0===b?[.5,.5]:b,w=o.projectionRotation,W=void 0===w?[0,0,0]:w,y=o.fillColor,M=void 0===y?"#dddddd":y,k=o.borderWidth,T=void 0===k?0:k,F=o.borderColor,S=void 0===F?"#000000":F,E=o.enableGraticule,L=void 0!==E&&E,R=o.graticuleLineWidth,B=void 0===R?.5:R,x=o.graticuleLineColor,P=void 0===x?"#999999":x,G=o.isInteractive,H=void 0===G||G,I=o.onClick,q=void 0===I?function(){}:I,O=o.onMouseMove,D=void 0===O?function(){}:O,K=o.tooltip,V=i(null),A=a(),N=u(e,r,l),Q=N.margin,U=N.outerWidth,X=N.outerHeight,Y=z({width:e,height:r,projectionType:g,projectionScale:C,projectionTranslation:j,projectionRotation:W,fillColor:M,borderWidth:T,borderColor:S}),Z=Y.projection,$=Y.graticule,_=Y.path,oo=Y.getFillColor,eo=Y.getBorderWidth,to=Y.getBorderColor;n((function(){if(V){V.current.width=U*c,V.current.height=X*c;var e=V.current.getContext("2d");e.scale(c,c),e.fillStyle=A.background,e.fillRect(0,0,U,X),e.translate(Q.left,Q.top),_.context(e),h.forEach((function(t){"graticule"===t?!0===L&&(e.lineWidth=B,e.strokeStyle=P,e.beginPath(),_($()),e.stroke()):"features"===t?f.forEach((function(o){e.beginPath(),_(o),e.fillStyle=oo(o),e.fill();var t=eo(o);t>0&&(e.strokeStyle=to(o),e.lineWidth=t,e.stroke())})):t(e,o)}))}}),[V,U,X,Q,c,A,_,$,oo,eo,to,f,h]);var ro=s(),io=ro.showTooltipFromEvent,no=ro.hideTooltip,ao=t((function(o){if(H&&K){var e=J(o,V.current,f,Z);e?io(p(K,{feature:e}),o):no(),D&&D(e||null,o)}}),[io,no,H,K,V,f,Z]),lo=t((function(){return H&&no()}),[H,no]),uo=t((function(o){if(H&&q){var e=J(o,V.current,f,Z);e&&q(e,o)}}),[H,V,f,Z,q]);return p("canvas",{ref:V,width:U*c,height:X*c,style:{width:U,height:X,cursor:H?"auto":"normal"},onMouseMove:ao,onMouseLeave:lo,onClick:uo})}))),Q=function(o){return p(f,{children:function(e){var t=e.width,r=e.height;return p(N,O({width:t,height:r},o))}})},U=o((function(o){var e=o.feature;return void 0===e.data?null:p(g,{id:e.label,color:e.color,enableChip:!0,value:e.formattedValue})})),X=c(o((function(o){var e=o.width,i=o.height,n=o.margin,l=o.features,c=o.data,f=o.match,h=void 0===f?"id":f,g=o.label,m=void 0===g?"id":g,C=o.value,b=void 0===C?"value":C,j=o.valueFormat,w=o.projectionType,W=void 0===w?"mercator":w,y=o.projectionScale,M=void 0===y?100:y,k=o.projectionTranslation,T=void 0===k?[.5,.5]:k,F=o.projectionRotation,S=void 0===F?[0,0,0]:F,E=o.colors,L=void 0===E?"PuBuGn":E,R=o.domain,B=o.unknownColor,x=void 0===B?"#999":B,P=o.borderWidth,H=void 0===P?0:P,D=o.borderColor,V=void 0===D?"#000000":D,A=o.enableGraticule,J=void 0!==A&&A,N=o.graticuleLineWidth,Q=void 0===N?.5:N,X=o.graticuleLineColor,Y=void 0===X?"#999999":X,Z=o.layers,$=void 0===Z?["graticule","features","legends"]:Z,_=o.legends,oo=void 0===_?[]:_,eo=o.isInteractive,to=void 0===eo||eo,ro=o.onClick,io=void 0===ro?function(){}:ro,no=o.tooltip,ao=void 0===no?U:no,lo=o.role,uo=void 0===lo?"img":lo,co=o.defs,fo=void 0===co?[]:co,ho=o.fill,vo=void 0===ho?[]:ho,so=u(e,i,n),go=so.margin,po=so.outerWidth,mo=so.outerHeight,Co=z({width:e,height:i,projectionType:W,projectionScale:M,projectionTranslation:T,projectionRotation:S,fillColor:function(){},borderWidth:H,borderColor:V}),bo=Co.graticule,jo=Co.path,wo=Co.getBorderWidth,Wo=Co.getBorderColor,yo=K({features:l,data:c,match:h,label:m,value:b,valueFormat:j,colors:L,unknownColor:x,domain:R}),Mo=yo.getFillColor,ko=yo.boundFeatures,To=yo.legendData,Fo=a(),So=v(fo,ko,vo,{dataKey:"data",targetKey:"fill"}),Eo=s(),Lo=Eo.showTooltipFromEvent,Ro=Eo.hideTooltip,Bo=t((function(o,e){return to&&io&&io(o,e)}),[to,io]),xo=t((function(o,e){return to&&ao&&Lo(p(ao,{feature:o}),e)}),[to,Lo,ao]),Po=t((function(o,e){return to&&ao&&Lo(p(ao,{feature:o}),e)}),[to,Lo,ao]),Go=t((function(){return to&&Ro()}),[to,Ro]);return p(d,{width:po,height:mo,margin:go,theme:Fo,defs:So,role:uo,children:$.map((function(o,t){return"graticule"===o?!0!==J?null:p(I,{path:jo,graticule:bo,lineWidth:Q,lineColor:Y},"graticule"):"features"===o?p(r,{children:ko.map((function(o){return p(q,{feature:o,path:jo,fillColor:Mo(o),borderWidth:wo(o),borderColor:Wo(o),onMouseEnter:xo,onMouseMove:Po,onMouseLeave:Go,onClick:Bo},o.id)}))},"features"):"legends"===o?oo.map((function(o,t){return p(G,O({containerWidth:e,containerHeight:i,data:To},o),t)})):p(r,{children:o({})},t)}))})}))),Y=function(o){return p(f,{children:function(e){var t=e.width,r=e.height;return p(X,O({width:t,height:r},o))}})},Z=function(o,e,t,r){var i=h(e,o),n=i[0],a=i[1];return t.find((function(o){return B(o,r.invert([n,a]))}))},$=c(o((function(o){var e=o.width,r=o.height,l=o.margin,d=o.pixelRatio,c=void 0===d?"undefined"!=typeof window&&window.devicePixelRatio||1:d,f=o.features,h=o.data,v=o.match,g=void 0===v?"id":v,m=o.label,C=void 0===m?"id":m,b=o.value,j=void 0===b?"value":b,w=o.valueFormat,W=o.projectionType,y=void 0===W?"mercator":W,M=o.projectionScale,k=void 0===M?100:M,T=o.projectionTranslation,F=void 0===T?[.5,.5]:T,S=o.projectionRotation,E=void 0===S?[0,0,0]:S,L=o.colors,R=void 0===L?"PuBuGn":L,B=o.domain,x=o.unknownColor,P=void 0===x?"#999":x,G=o.borderWidth,I=void 0===G?0:G,q=o.borderColor,D=void 0===q?"#000000":q,V=o.enableGraticule,A=void 0!==V&&V,J=o.graticuleLineWidth,N=void 0===J?.5:J,Q=o.graticuleLineColor,X=void 0===Q?"#999999":Q,Y=o.layers,$=void 0===Y?["graticule","features","legends"]:Y,_=o.legends,oo=void 0===_?[]:_,eo=o.isInteractive,to=void 0===eo||eo,ro=o.onClick,io=void 0===ro?function(){}:ro,no=o.onMouseMove,ao=void 0===no?function(){}:no,lo=o.tooltip,uo=void 0===lo?U:lo,co=i(null),fo=a(),ho=u(e,r,l),vo=ho.margin,so=ho.outerWidth,go=ho.outerHeight,po=z({width:e,height:r,projectionType:y,projectionScale:k,projectionTranslation:F,projectionRotation:E,fillColor:function(){},borderWidth:I,borderColor:D}),mo=po.projection,Co=po.graticule,bo=po.path,jo=po.getBorderWidth,wo=po.getBorderColor,Wo=K({features:f,data:h,match:g,label:C,value:j,valueFormat:w,colors:R,unknownColor:P,domain:B}),yo=Wo.getFillColor,Mo=Wo.boundFeatures,ko=Wo.legendData;n((function(){if(co){co.current.width=so*c,co.current.height=go*c;var o=co.current.getContext("2d");o.scale(c,c),o.fillStyle=fo.background,o.fillRect(0,0,so,go),o.translate(vo.left,vo.top),bo.context(o),$.forEach((function(t){"graticule"===t?!0===A&&(o.lineWidth=N,o.strokeStyle=X,o.beginPath(),bo(Co()),o.stroke()):"features"===t?Mo.forEach((function(e){o.beginPath(),bo(e),o.fillStyle=yo(e),o.fill();var t=jo(e);t>0&&(o.strokeStyle=wo(e),o.lineWidth=t,o.stroke())})):"legends"===t&&oo.forEach((function(t){H(o,O({},t,{data:ko,containerWidth:e,containerHeight:r,theme:fo}))}))}))}}),[co,so,go,vo,c,fo,bo,Co,yo,jo,wo,Mo,oo,$]);var To=s(),Fo=To.showTooltipFromEvent,So=To.hideTooltip,Eo=t((function(o){if(to&&uo){var e=Z(o,co.current,Mo,mo);e?Fo(p(uo,{feature:e}),o):So(),ao&&ao(e||null,o)}}),[Fo,So,to,uo,co,Mo,mo]),Lo=t((function(){return to&&So()}),[to,So]),Ro=t((function(o){if(to&&io){var e=Z(o,co.current,Mo,mo);e&&io(e,o)}}),[to,co,Mo,mo,io]);return p("canvas",{ref:co,width:so*c,height:go*c,style:{width:so,height:go,cursor:to?"auto":"normal"},onMouseMove:Eo,onMouseLeave:Lo,onClick:Ro})}))),_=function(o){return p(f,{children:function(e){var t=e.width,r=e.height;return p($,O({width:t,height:r},o))}})},oo={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},eo=O({},oo,{role:"img"}),to=O({},oo,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),ro={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:U,layers:["graticule","features","legends"]},io=O({},eo,ro,{role:"img"}),no=O({},to,ro);export{X as Choropleth,$ as ChoroplethCanvas,no as ChoroplethCanvasDefaultProps,io as ChoroplethDefaultProps,V as GeoMap,N as GeoMapCanvas,to as GeoMapCanvasDefaultProps,eo as GeoMapDefaultProps,Y as ResponsiveChoropleth,_ as ResponsiveChoroplethCanvas,A as ResponsiveGeoMap,Q as ResponsiveGeoMapCanvas,D as projectionById,K as useChoropleth,z as useGeoMap};
//# sourceMappingURL=nivo-geo.mjs.map
