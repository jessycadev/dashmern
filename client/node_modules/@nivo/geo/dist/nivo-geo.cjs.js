"use strict";var e=require("react"),o=require("@nivo/core"),t=require("@nivo/tooltip"),r=require("react/jsx-runtime"),i=require("lodash/isFunction.js"),n=require("lodash/get.js"),a=require("d3-format"),l=require("d3-geo"),u=require("@nivo/colors"),c=require("@nivo/legends"),d=e.memo((function(e){var o=e.path,t=e.graticule,i=e.lineWidth,n=e.lineColor;return r.jsx("path",{fill:"none",strokeWidth:i,stroke:n,d:o(t())})})),s=e.memo((function(e){var o,t=e.feature,i=e.path,n=e.fillColor,a=e.borderWidth,l=e.borderColor,u=e.onClick,c=e.onMouseEnter,d=e.onMouseMove,s=e.onMouseLeave;return r.jsx("path",{fill:null!=(o=null==t?void 0:t.fill)?o:n,strokeWidth:a,stroke:l,strokeLinejoin:"bevel",d:i(t),onMouseEnter:function(e){return c(t,e)},onMouseMove:function(e){return d(t,e)},onMouseLeave:function(e){return s(t,e)},onClick:function(e){return u(t,e)}},t.id)}));function h(){return h=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h.apply(this,arguments)}var f={azimuthalEqualArea:l.geoAzimuthalEqualArea,azimuthalEquidistant:l.geoAzimuthalEquidistant,gnomonic:l.geoGnomonic,orthographic:l.geoOrthographic,stereographic:l.geoStereographic,equalEarth:l.geoEqualEarth,equirectangular:l.geoEquirectangular,mercator:l.geoMercator,transverseMercator:l.geoTransverseMercator,naturalEarth1:l.geoNaturalEarth1},v=function(t){var r=t.width,i=t.height,n=t.projectionType,a=t.projectionScale,c=t.projectionTranslation,d=t.projectionRotation,s=t.fillColor,h=t.borderWidth,v=t.borderColor,p=e.useMemo((function(){return f[n]().scale(a).translate([r*c[0],i*c[1]]).rotate(d)}),[r,i,n,a,c[0],c[1],d[0],d[1],d[2]]),g=e.useMemo((function(){return l.geoPath(p)}),[p]),m=e.useMemo((function(){return l.geoGraticule()})),C=o.useTheme(),j=e.useMemo((function(){return"function"==typeof h?h:function(){return h}}),[h]),b=u.useInheritedColor(v,C),x=e.useMemo((function(){return"function"==typeof s?s:function(){return s}}),[s]);return{projection:p,path:g,graticule:m,getBorderWidth:j,getBorderColor:b,getFillColor:x}},p=function(t){var r=t.features,l=t.data,u=t.match,d=t.label,s=t.value,f=t.valueFormat,v=t.colors,p=t.unknownColor,g=t.domain,m=e.useMemo((function(){return i(u)?u:function(e,o){var t=n(e,u),r=n(o,u);return t&&t===r}}),[u]),C=e.useMemo((function(){return i(d)?d:function(e){return n(e,d)}}),[d]),j=e.useMemo((function(){return i(s)?s:function(e){return n(e,s)}}),[s]),b=e.useMemo((function(){return void 0===f?function(e){return e}:i(f)?f:a.format(f)}),[f]),x=e.useMemo((function(){return o.guessQuantizeColorScale(v).domain(g)}),[v,g]),w=e.useMemo((function(){return function(e){return void 0===e.value?p:x(e.value)}}),[x,p]),M=e.useMemo((function(){return r.map((function(e){var o=l.find((function(o){return m(e,o)})),t=j(o);if(o){var r=h({},e,{data:o,value:t,formattedValue:b(t)});return r.color=w(r),r.label=C(r),r}return e}))}),[r,l,m,j,b,w]),k=c.useQuantizeColorScaleLegendData({scale:x,valueFormat:b});return{colorScale:x,getFillColor:w,boundFeatures:M,valueFormatter:b,legendData:k}},g=e.memo((function(i){var n=i.width,a=i.height,l=i.margin,u=i.features,c=i.layers,h=void 0===c?["graticule","features"]:c,f=i.projectionType,p=void 0===f?"mercator":f,g=i.projectionScale,m=void 0===g?100:g,C=i.projectionTranslation,j=void 0===C?[.5,.5]:C,b=i.projectionRotation,x=void 0===b?[0,0,0]:b,w=i.fillColor,M=void 0===w?"#dddddd":w,k=i.borderWidth,W=void 0===k?0:k,T=i.borderColor,y=void 0===T?"#000000":T,R=i.enableGraticule,E=void 0!==R&&R,F=i.graticuleLineWidth,S=void 0===F?.5:F,L=i.graticuleLineColor,q=void 0===L?"#999999":L,G=i.isInteractive,B=void 0===G||G,P=i.onClick,D=void 0===P?function(){}:P,I=i.tooltip,z=i.role,H=void 0===z?"img":z,O=o.useDimensions(n,a,l),A=O.margin,K=O.outerWidth,Q=O.outerHeight,V=v({width:n,height:a,projectionType:p,projectionScale:m,projectionTranslation:j,projectionRotation:x,fillColor:M,borderWidth:W,borderColor:y}),N=V.graticule,J=V.path,U=V.getFillColor,X=V.getBorderWidth,Y=V.getBorderColor,Z=o.useTheme(),$=t.useTooltip(),_=$.showTooltipFromEvent,ee=$.hideTooltip,oe=e.useCallback((function(e,o){return B&&D&&D(e,o)}),[B,D]),te=e.useCallback((function(e,o){return B&&I&&_(r.jsx(I,{feature:e}),o)}),[B,_,I]),re=e.useCallback((function(e,o){return B&&I&&_(r.jsx(I,{feature:e}),o)}),[B,_,I]),ie=e.useCallback((function(){return B&&ee()}),[B,ee]);return r.jsx(o.SvgWrapper,{width:K,height:Q,margin:A,theme:Z,role:H,children:h.map((function(o,t){return"graticule"===o?!0!==E?null:r.jsx(d,{path:J,graticule:N,lineWidth:S,lineColor:q},"graticule"):"features"===o?r.jsx(e.Fragment,{children:u.map((function(e){return r.jsx(s,{feature:e,path:J,fillColor:U(e),borderWidth:X(e),borderColor:Y(e),onMouseEnter:te,onMouseMove:re,onMouseLeave:ie,onClick:oe},e.id)}))},"features"):r.jsx(e.Fragment,{children:o(i)},t)}))})})),m=o.withContainer(g),C=function(e,t,r,i){var n=o.getRelativeCursor(t,e),a=n[0],u=n[1];return r.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},j=e.memo((function(i){var n=i.width,a=i.height,l=i.margin,u=i.pixelRatio,c=void 0===u?"undefined"!=typeof window&&window.devicePixelRatio||1:u,d=i.features,s=i.layers,h=i.projectionType,f=void 0===h?"mercator":h,p=i.projectionScale,g=void 0===p?100:p,m=i.projectionTranslation,j=void 0===m?[.5,.5]:m,b=i.projectionRotation,x=void 0===b?[0,0,0]:b,w=i.fillColor,M=void 0===w?"#dddddd":w,k=i.borderWidth,W=void 0===k?0:k,T=i.borderColor,y=void 0===T?"#000000":T,R=i.enableGraticule,E=void 0!==R&&R,F=i.graticuleLineWidth,S=void 0===F?.5:F,L=i.graticuleLineColor,q=void 0===L?"#999999":L,G=i.isInteractive,B=void 0===G||G,P=i.onClick,D=void 0===P?function(){}:P,I=i.onMouseMove,z=void 0===I?function(){}:I,H=i.tooltip,O=e.useRef(null),A=o.useTheme(),K=o.useDimensions(n,a,l),Q=K.margin,V=K.outerWidth,N=K.outerHeight,J=v({width:n,height:a,projectionType:f,projectionScale:g,projectionTranslation:j,projectionRotation:x,fillColor:M,borderWidth:W,borderColor:y}),U=J.projection,X=J.graticule,Y=J.path,Z=J.getFillColor,$=J.getBorderWidth,_=J.getBorderColor;e.useEffect((function(){if(O){O.current.width=V*c,O.current.height=N*c;var e=O.current.getContext("2d");e.scale(c,c),e.fillStyle=A.background,e.fillRect(0,0,V,N),e.translate(Q.left,Q.top),Y.context(e),s.forEach((function(o){"graticule"===o?!0===E&&(e.lineWidth=S,e.strokeStyle=q,e.beginPath(),Y(X()),e.stroke()):"features"===o?d.forEach((function(o){e.beginPath(),Y(o),e.fillStyle=Z(o),e.fill();var t=$(o);t>0&&(e.strokeStyle=_(o),e.lineWidth=t,e.stroke())})):o(e,i)}))}}),[O,V,N,Q,c,A,Y,X,Z,$,_,d,s]);var ee=t.useTooltip(),oe=ee.showTooltipFromEvent,te=ee.hideTooltip,re=e.useCallback((function(e){if(B&&H){var o=C(e,O.current,d,U);o?oe(r.jsx(H,{feature:o}),e):te(),z&&z(o||null,e)}}),[oe,te,B,H,O,d,U]),ie=e.useCallback((function(){return B&&te()}),[B,te]),ne=e.useCallback((function(e){if(B&&D){var o=C(e,O.current,d,U);o&&D(o,e)}}),[B,O,d,U,D]);return r.jsx("canvas",{ref:O,width:V*c,height:N*c,style:{width:V,height:N,cursor:B?"auto":"normal"},onMouseMove:re,onMouseLeave:ie,onClick:ne})})),b=o.withContainer(j),x=e.memo((function(e){var o=e.feature;return void 0===o.data?null:r.jsx(t.BasicTooltip,{id:o.label,color:o.color,enableChip:!0,value:o.formattedValue})})),w=e.memo((function(i){var n=i.width,a=i.height,l=i.margin,u=i.features,f=i.data,g=i.match,m=void 0===g?"id":g,C=i.label,j=void 0===C?"id":C,b=i.value,w=void 0===b?"value":b,M=i.valueFormat,k=i.projectionType,W=void 0===k?"mercator":k,T=i.projectionScale,y=void 0===T?100:T,R=i.projectionTranslation,E=void 0===R?[.5,.5]:R,F=i.projectionRotation,S=void 0===F?[0,0,0]:F,L=i.colors,q=void 0===L?"PuBuGn":L,G=i.domain,B=i.unknownColor,P=void 0===B?"#999":B,D=i.borderWidth,I=void 0===D?0:D,z=i.borderColor,H=void 0===z?"#000000":z,O=i.enableGraticule,A=void 0!==O&&O,K=i.graticuleLineWidth,Q=void 0===K?.5:K,V=i.graticuleLineColor,N=void 0===V?"#999999":V,J=i.layers,U=void 0===J?["graticule","features","legends"]:J,X=i.legends,Y=void 0===X?[]:X,Z=i.isInteractive,$=void 0===Z||Z,_=i.onClick,ee=void 0===_?function(){}:_,oe=i.tooltip,te=void 0===oe?x:oe,re=i.role,ie=void 0===re?"img":re,ne=i.defs,ae=void 0===ne?[]:ne,le=i.fill,ue=void 0===le?[]:le,ce=o.useDimensions(n,a,l),de=ce.margin,se=ce.outerWidth,he=ce.outerHeight,fe=v({width:n,height:a,projectionType:W,projectionScale:y,projectionTranslation:E,projectionRotation:S,fillColor:function(){},borderWidth:I,borderColor:H}),ve=fe.graticule,pe=fe.path,ge=fe.getBorderWidth,me=fe.getBorderColor,Ce=p({features:u,data:f,match:m,label:j,value:w,valueFormat:M,colors:q,unknownColor:P,domain:G}),je=Ce.getFillColor,be=Ce.boundFeatures,xe=Ce.legendData,we=o.useTheme(),Me=o.bindDefs(ae,be,ue,{dataKey:"data",targetKey:"fill"}),ke=t.useTooltip(),We=ke.showTooltipFromEvent,Te=ke.hideTooltip,ye=e.useCallback((function(e,o){return $&&ee&&ee(e,o)}),[$,ee]),Re=e.useCallback((function(e,o){return $&&te&&We(r.jsx(te,{feature:e}),o)}),[$,We,te]),Ee=e.useCallback((function(e,o){return $&&te&&We(r.jsx(te,{feature:e}),o)}),[$,We,te]),Fe=e.useCallback((function(){return $&&Te()}),[$,Te]);return r.jsx(o.SvgWrapper,{width:se,height:he,margin:de,theme:we,defs:Me,role:ie,children:U.map((function(o,t){return"graticule"===o?!0!==A?null:r.jsx(d,{path:pe,graticule:ve,lineWidth:Q,lineColor:N},"graticule"):"features"===o?r.jsx(e.Fragment,{children:be.map((function(e){return r.jsx(s,{feature:e,path:pe,fillColor:je(e),borderWidth:ge(e),borderColor:me(e),onMouseEnter:Re,onMouseMove:Ee,onMouseLeave:Fe,onClick:ye},e.id)}))},"features"):"legends"===o?Y.map((function(e,o){return r.jsx(c.BoxLegendSvg,h({containerWidth:n,containerHeight:a,data:xe},e),o)})):r.jsx(e.Fragment,{children:o({})},t)}))})})),M=o.withContainer(w),k=function(e,t,r,i){var n=o.getRelativeCursor(t,e),a=n[0],u=n[1];return r.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},W=e.memo((function(i){var n=i.width,a=i.height,l=i.margin,u=i.pixelRatio,d=void 0===u?"undefined"!=typeof window&&window.devicePixelRatio||1:u,s=i.features,f=i.data,g=i.match,m=void 0===g?"id":g,C=i.label,j=void 0===C?"id":C,b=i.value,w=void 0===b?"value":b,M=i.valueFormat,W=i.projectionType,T=void 0===W?"mercator":W,y=i.projectionScale,R=void 0===y?100:y,E=i.projectionTranslation,F=void 0===E?[.5,.5]:E,S=i.projectionRotation,L=void 0===S?[0,0,0]:S,q=i.colors,G=void 0===q?"PuBuGn":q,B=i.domain,P=i.unknownColor,D=void 0===P?"#999":P,I=i.borderWidth,z=void 0===I?0:I,H=i.borderColor,O=void 0===H?"#000000":H,A=i.enableGraticule,K=void 0!==A&&A,Q=i.graticuleLineWidth,V=void 0===Q?.5:Q,N=i.graticuleLineColor,J=void 0===N?"#999999":N,U=i.layers,X=void 0===U?["graticule","features","legends"]:U,Y=i.legends,Z=void 0===Y?[]:Y,$=i.isInteractive,_=void 0===$||$,ee=i.onClick,oe=void 0===ee?function(){}:ee,te=i.onMouseMove,re=void 0===te?function(){}:te,ie=i.tooltip,ne=void 0===ie?x:ie,ae=e.useRef(null),le=o.useTheme(),ue=o.useDimensions(n,a,l),ce=ue.margin,de=ue.outerWidth,se=ue.outerHeight,he=v({width:n,height:a,projectionType:T,projectionScale:R,projectionTranslation:F,projectionRotation:L,fillColor:function(){},borderWidth:z,borderColor:O}),fe=he.projection,ve=he.graticule,pe=he.path,ge=he.getBorderWidth,me=he.getBorderColor,Ce=p({features:s,data:f,match:m,label:j,value:w,valueFormat:M,colors:G,unknownColor:D,domain:B}),je=Ce.getFillColor,be=Ce.boundFeatures,xe=Ce.legendData;e.useEffect((function(){if(ae){ae.current.width=de*d,ae.current.height=se*d;var e=ae.current.getContext("2d");e.scale(d,d),e.fillStyle=le.background,e.fillRect(0,0,de,se),e.translate(ce.left,ce.top),pe.context(e),X.forEach((function(o){"graticule"===o?!0===K&&(e.lineWidth=V,e.strokeStyle=J,e.beginPath(),pe(ve()),e.stroke()):"features"===o?be.forEach((function(o){e.beginPath(),pe(o),e.fillStyle=je(o),e.fill();var t=ge(o);t>0&&(e.strokeStyle=me(o),e.lineWidth=t,e.stroke())})):"legends"===o&&Z.forEach((function(o){c.renderLegendToCanvas(e,h({},o,{data:xe,containerWidth:n,containerHeight:a,theme:le}))}))}))}}),[ae,de,se,ce,d,le,pe,ve,je,ge,me,be,Z,X]);var we=t.useTooltip(),Me=we.showTooltipFromEvent,ke=we.hideTooltip,We=e.useCallback((function(e){if(_&&ne){var o=k(e,ae.current,be,fe);o?Me(r.jsx(ne,{feature:o}),e):ke(),re&&re(o||null,e)}}),[Me,ke,_,ne,ae,be,fe]),Te=e.useCallback((function(){return _&&ke()}),[_,ke]),ye=e.useCallback((function(e){if(_&&oe){var o=k(e,ae.current,be,fe);o&&oe(o,e)}}),[_,ae,be,fe,oe]);return r.jsx("canvas",{ref:ae,width:de*d,height:se*d,style:{width:de,height:se,cursor:_?"auto":"normal"},onMouseMove:We,onMouseLeave:Te,onClick:ye})})),T=o.withContainer(W),y={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},R=h({},y,{role:"img"}),E=h({},y,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),F={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:x,layers:["graticule","features","legends"]},S=h({},R,F,{role:"img"}),L=h({},E,F);exports.Choropleth=M,exports.ChoroplethCanvas=T,exports.ChoroplethCanvasDefaultProps=L,exports.ChoroplethDefaultProps=S,exports.GeoMap=m,exports.GeoMapCanvas=b,exports.GeoMapCanvasDefaultProps=E,exports.GeoMapDefaultProps=R,exports.ResponsiveChoropleth=function(e){return r.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,i=o.height;return r.jsx(M,h({width:t,height:i},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return r.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,i=o.height;return r.jsx(T,h({width:t,height:i},e))}})},exports.ResponsiveGeoMap=function(e){return r.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,i=o.height;return r.jsx(m,h({width:t,height:i},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return r.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,i=o.height;return r.jsx(b,h({width:t,height:i},e))}})},exports.projectionById=f,exports.useChoropleth=p,exports.useGeoMap=v;
//# sourceMappingURL=nivo-geo.cjs.js.map
