import{useMemo as e,useRef as i,useEffect as t,useState as a,useCallback as n,createElement as r,Fragment as o}from"react";import{usePropertyAccessor as d,useValueFormatter as l,degreesToRadians as s,radiansToDegrees as c,Container as u,useDimensions as v,bindDefs as f,SvgWrapper as g,ResponsiveWrapper as L,useTheme as h,getRelativeCursor as b}from"@nivo/core";import{useArcGenerator as A,computeArcBoundingBox as p,ArcsLayer as k,ArcLinkLabelsLayer as R,ArcLabelsLayer as I,useArcLabels as m,useArcLinkLabels as O,drawCanvasArcLinkLabels as C,drawCanvasArcLabels as x,findArcUnderCursor as w}from"@nivo/arcs";import{BoxLegendSvg as M,renderLegendToCanvas as y}from"@nivo/legends";import{jsx as S,Fragment as W}from"react/jsx-runtime";import{pie as T}from"d3-shape";import{useOrdinalColorScale as D,useInheritedColor as V}from"@nivo/colors";import{BasicTooltip as B,useTooltip as G}from"@nivo/tooltip";function E(){return E=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},E.apply(this,arguments)}function F(e,i){if(null==e)return{};var t,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],i.indexOf(t)>=0||(n[t]=e[t]);return n}var H,X=function(e){var i=e.width,t=e.height,a=e.legends,n=e.data,r=e.toggleSerie;return S(W,{children:a.map((function(e,a){var o;return S(M,E({},e,{containerWidth:i,containerHeight:t,data:null!=(o=e.data)?o:n,toggleSerie:e.toggleSerie?r:void 0}),a)}))})},Y={id:"id",value:"value",sortByValue:!1,innerRadius:0,padAngle:0,cornerRadius:0,layers:["arcs","arcLinkLabels","arcLabels","legends"],startAngle:0,endAngle:360,fit:!0,activeInnerRadiusOffset:0,activeOuterRadiusOffset:0,borderWidth:0,borderColor:{from:"color",modifiers:[["darker",1]]},enableArcLabels:!0,arcLabel:"formattedValue",arcLabelsSkipAngle:0,arcLabelsSkipRadius:0,arcLabelsRadiusOffset:.5,arcLabelsTextColor:{theme:"labels.text.fill"},enableArcLinkLabels:!0,arcLinkLabel:"id",arcLinkLabelsSkipAngle:0,arcLinkLabelsOffset:0,arcLinkLabelsDiagonalLength:16,arcLinkLabelsStraightLength:24,arcLinkLabelsThickness:1,arcLinkLabelsTextOffset:6,arcLinkLabelsTextColor:{theme:"labels.text.fill"},arcLinkLabelsColor:{theme:"axis.ticks.line.stroke"},colors:{scheme:"nivo"},defs:[],fill:[],isInteractive:!0,animate:!0,motionConfig:"gentle",transitionMode:"innerRadius",tooltip:function(e){var i=e.datum;return S(B,{id:i.id,value:i.formattedValue,enableChip:!0,color:i.color})},legends:[],role:"img",pixelRatio:"undefined"!=typeof window&&null!=(H=window.devicePixelRatio)?H:1},j=["points"],P=function(i){var t=i.data,a=i.id,n=void 0===a?Y.id:a,r=i.value,o=void 0===r?Y.value:r,s=i.valueFormat,c=i.colors,u=void 0===c?Y.colors:c,v=d(n),f=d(o),g=l(s),L=D(u,"id");return e((function(){return t.map((function(e){var i,t=v(e),a=f(e),n={id:t,label:null!=(i=e.label)?i:t,hidden:!1,value:a,formattedValue:g(a),data:e};return E({},n,{color:L(n)})}))}),[t,v,f,g,L])},q=function(a){var n=a.data,r=a.startAngle,o=a.endAngle,d=a.innerRadius,l=a.outerRadius,u=a.padAngle,v=a.sortByValue,f=a.activeId,g=a.activeInnerRadiusOffset,L=a.activeOuterRadiusOffset,h=a.hiddenIds,b=a.forwardLegendData,A=e((function(){var e=T().value((function(e){return e.value})).startAngle(s(r)).endAngle(s(o)).padAngle(s(u));return v||e.sortValues(null),e}),[r,o,u,v]),p=e((function(){var e=n.filter((function(e){return!h.includes(e.id)}));return{dataWithArc:A(e).map((function(e){var i=Math.abs(e.endAngle-e.startAngle);return E({},e.data,{arc:{index:e.index,startAngle:e.startAngle,endAngle:e.endAngle,innerRadius:f===e.data.id?d-g:d,outerRadius:f===e.data.id?l+L:l,thickness:l-d,padAngle:e.padAngle,angle:i,angleDeg:c(i)}})})),legendData:n.map((function(e){return{id:e.id,label:e.label,color:e.color,hidden:h.includes(e.id),data:e}}))}}),[A,n,h,f,d,g,l,L]),k=p.legendData,R=i(b);return t((function(){"function"==typeof R.current&&R.current(k)}),[R,k]),p},z=function(e){var i=e.activeId,t=e.onActiveIdChange,r=e.defaultActiveId,o=void 0!==i,d=a(o?null:void 0===r?null:r),l=d[0],s=d[1];return{activeId:o?i:l,setActiveId:n((function(e){t&&t(e),o||s(e)}),[o,t,s])}},J=function(e){var i=e.data,t=e.radius,r=e.innerRadius,o=e.startAngle,d=void 0===o?Y.startAngle:o,l=e.endAngle,c=void 0===l?Y.endAngle:l,u=e.padAngle,v=void 0===u?Y.padAngle:u,f=e.sortByValue,g=void 0===f?Y.sortByValue:f,L=e.cornerRadius,h=void 0===L?Y.cornerRadius:L,b=e.activeInnerRadiusOffset,p=void 0===b?Y.activeInnerRadiusOffset:b,k=e.activeOuterRadiusOffset,R=void 0===k?Y.activeOuterRadiusOffset:k,I=e.activeId,m=e.onActiveIdChange,O=e.defaultActiveId,C=e.forwardLegendData,x=z({activeId:I,onActiveIdChange:m,defaultActiveId:O}),w=x.activeId,M=x.setActiveId,y=a([]),S=y[0],W=y[1],T=q({data:i,startAngle:d,endAngle:c,innerRadius:r,outerRadius:t,padAngle:v,sortByValue:g,activeId:w,activeInnerRadiusOffset:p,activeOuterRadiusOffset:R,hiddenIds:S,forwardLegendData:C}),D=n((function(e){W((function(i){return i.indexOf(e)>-1?i.filter((function(i){return i!==e})):[].concat(i,[e])}))}),[]);return E({},T,{arcGenerator:A({cornerRadius:h,padAngle:s(v)}),setActiveId:M,toggleSerie:D})},K=function(i){var t=i.data,r=i.width,o=i.height,d=i.innerRadius,l=void 0===d?Y.innerRadius:d,c=i.startAngle,u=void 0===c?Y.startAngle:c,v=i.endAngle,f=void 0===v?Y.endAngle:v,g=i.padAngle,L=void 0===g?Y.padAngle:g,h=i.sortByValue,b=void 0===h?Y.sortByValue:h,k=i.cornerRadius,R=void 0===k?Y.cornerRadius:k,I=i.fit,m=void 0===I?Y.fit:I,O=i.activeInnerRadiusOffset,C=void 0===O?Y.activeInnerRadiusOffset:O,x=i.activeOuterRadiusOffset,w=void 0===x?Y.activeOuterRadiusOffset:x,M=i.activeId,y=i.onActiveIdChange,S=i.defaultActiveId,W=i.forwardLegendData,T=z({activeId:M,onActiveIdChange:y,defaultActiveId:S}),D=T.activeId,V=T.setActiveId,B=a([]),G=B[0],H=B[1],X=e((function(){var e,i=Math.min(r,o)/2,t=i*Math.min(l,1),a=r/2,n=o/2;if(m){var d=p(a,n,i,u-90,f-90),s=d.points,c=F(d,j),v=Math.min(r/c.width,o/c.height),g={width:c.width*v,height:c.height*v};g.x=(r-g.width)/2,g.y=(o-g.height)/2,a=(a-c.x)/c.width*c.width*v+g.x,n=(n-c.y)/c.height*c.height*v+g.y,e={box:c,ratio:v,points:s},i*=v,t*=v}return{centerX:a,centerY:n,radius:i,innerRadius:t,debug:e}}),[r,o,l,u,f,m]),P=q({data:t,startAngle:u,endAngle:f,innerRadius:X.innerRadius,outerRadius:X.radius,padAngle:L,sortByValue:b,activeId:D,activeInnerRadiusOffset:C,activeOuterRadiusOffset:w,hiddenIds:G,forwardLegendData:W}),J=n((function(e){H((function(i){return i.indexOf(e)>-1?i.filter((function(i){return i!==e})):[].concat(i,[e])}))}),[]);return E({arcGenerator:A({cornerRadius:R,padAngle:s(L)}),activeId:D,setActiveId:V,toggleSerie:J},P,X)},N=function(i){var t=i.dataWithArc,a=i.arcGenerator,n=i.centerX,r=i.centerY,o=i.radius,d=i.innerRadius;return e((function(){return{dataWithArc:t,arcGenerator:a,centerX:n,centerY:r,radius:o,innerRadius:d}}),[t,a,n,r,o,d])},Q=function(i){var t=i.center,a=i.data,n=i.arcGenerator,o=i.borderWidth,d=i.borderColor,l=i.isInteractive,s=i.onClick,c=i.onMouseEnter,u=i.onMouseMove,v=i.onMouseLeave,f=i.setActiveId,g=i.tooltip,L=i.transitionMode,h=G(),b=h.showTooltipFromEvent,A=h.hideTooltip,p=e((function(){if(l)return function(e,i){null==s||s(e,i)}}),[l,s]),R=e((function(){if(l)return function(e,i){b(r(g,{datum:e}),i),f(e.id),null==c||c(e,i)}}),[l,b,f,c,g]),I=e((function(){if(l)return function(e,i){b(r(g,{datum:e}),i),null==u||u(e,i)}}),[l,b,u,g]),m=e((function(){if(l)return function(e,i){A(),f(null),null==v||v(e,i)}}),[l,A,f,v]);return S(k,{center:t,data:a,arcGenerator:n,borderWidth:o,borderColor:d,transitionMode:L,onClick:p,onMouseEnter:R,onMouseMove:I,onMouseLeave:m})},U=["isInteractive","animate","motionConfig","theme","renderWrapper"],Z=function(e){var i=e.data,t=e.id,a=void 0===t?Y.id:t,n=e.value,d=void 0===n?Y.value:n,l=e.valueFormat,s=e.sortByValue,c=void 0===s?Y.sortByValue:s,u=e.layers,L=void 0===u?Y.layers:u,h=e.startAngle,b=void 0===h?Y.startAngle:h,A=e.endAngle,p=void 0===A?Y.endAngle:A,k=e.padAngle,m=void 0===k?Y.padAngle:k,O=e.fit,C=void 0===O?Y.fit:O,x=e.innerRadius,w=void 0===x?Y.innerRadius:x,M=e.cornerRadius,y=void 0===M?Y.cornerRadius:M,W=e.activeInnerRadiusOffset,T=void 0===W?Y.activeInnerRadiusOffset:W,D=e.activeOuterRadiusOffset,V=void 0===D?Y.activeOuterRadiusOffset:D,B=e.width,G=e.height,E=e.margin,F=e.colors,H=void 0===F?Y.colors:F,j=e.borderWidth,q=void 0===j?Y.borderWidth:j,z=e.borderColor,J=void 0===z?Y.borderColor:z,U=e.enableArcLabels,Z=void 0===U?Y.enableArcLabels:U,$=e.arcLabel,_=void 0===$?Y.arcLabel:$,ee=e.arcLabelsSkipAngle,ie=void 0===ee?Y.arcLabelsSkipAngle:ee,te=e.arcLabelsSkipRadius,ae=void 0===te?Y.arcLabelsSkipRadius:te,ne=e.arcLabelsTextColor,re=void 0===ne?Y.arcLabelsTextColor:ne,oe=e.arcLabelsRadiusOffset,de=void 0===oe?Y.arcLabelsRadiusOffset:oe,le=e.arcLabelsComponent,se=e.enableArcLinkLabels,ce=void 0===se?Y.enableArcLinkLabels:se,ue=e.arcLinkLabel,ve=void 0===ue?Y.arcLinkLabel:ue,fe=e.arcLinkLabelsSkipAngle,ge=void 0===fe?Y.arcLinkLabelsSkipAngle:fe,Le=e.arcLinkLabelsOffset,he=void 0===Le?Y.arcLinkLabelsOffset:Le,be=e.arcLinkLabelsDiagonalLength,Ae=void 0===be?Y.arcLinkLabelsDiagonalLength:be,pe=e.arcLinkLabelsStraightLength,ke=void 0===pe?Y.arcLinkLabelsStraightLength:pe,Re=e.arcLinkLabelsThickness,Ie=void 0===Re?Y.arcLinkLabelsThickness:Re,me=e.arcLinkLabelsTextOffset,Oe=void 0===me?Y.arcLinkLabelsTextOffset:me,Ce=e.arcLinkLabelsTextColor,xe=void 0===Ce?Y.arcLinkLabelsTextColor:Ce,we=e.arcLinkLabelsColor,Me=void 0===we?Y.arcLinkLabelsColor:we,ye=e.arcLinkLabelComponent,Se=e.defs,We=void 0===Se?Y.defs:Se,Te=e.fill,De=void 0===Te?Y.fill:Te,Ve=e.isInteractive,Be=void 0===Ve?Y.isInteractive:Ve,Ge=e.onClick,Ee=e.onMouseEnter,Fe=e.onMouseMove,He=e.onMouseLeave,Xe=e.tooltip,Ye=void 0===Xe?Y.tooltip:Xe,je=e.activeId,Pe=e.onActiveIdChange,qe=e.defaultActiveId,ze=e.transitionMode,Je=void 0===ze?Y.transitionMode:ze,Ke=e.legends,Ne=void 0===Ke?Y.legends:Ke,Qe=e.forwardLegendData,Ue=e.role,Ze=void 0===Ue?Y.role:Ue,$e=v(B,G,E),_e=$e.outerWidth,ei=$e.outerHeight,ii=$e.margin,ti=$e.innerWidth,ai=$e.innerHeight,ni=P({data:i,id:a,value:d,valueFormat:l,colors:H}),ri=K({data:ni,width:ti,height:ai,fit:C,innerRadius:w,startAngle:b,endAngle:p,padAngle:m,sortByValue:c,cornerRadius:y,activeInnerRadiusOffset:T,activeOuterRadiusOffset:V,activeId:je,onActiveIdChange:Pe,defaultActiveId:qe,forwardLegendData:Qe}),oi=ri.dataWithArc,di=ri.legendData,li=ri.arcGenerator,si=ri.centerX,ci=ri.centerY,ui=ri.radius,vi=ri.innerRadius,fi=ri.setActiveId,gi=ri.toggleSerie,Li=f(We,oi,De),hi={arcs:null,arcLinkLabels:null,arcLabels:null,legends:null};L.includes("arcs")&&(hi.arcs=S(Q,{center:[si,ci],data:oi,arcGenerator:li,borderWidth:q,borderColor:J,isInteractive:Be,onClick:Ge,onMouseEnter:Ee,onMouseMove:Fe,onMouseLeave:He,setActiveId:fi,tooltip:Ye,transitionMode:Je},"arcs")),ce&&L.includes("arcLinkLabels")&&(hi.arcLinkLabels=S(R,{center:[si,ci],data:oi,label:ve,skipAngle:ge,offset:he,diagonalLength:Ae,straightLength:ke,strokeWidth:Ie,textOffset:Oe,textColor:xe,linkColor:Me,component:ye},"arcLinkLabels")),Z&&L.includes("arcLabels")&&(hi.arcLabels=S(I,{center:[si,ci],data:oi,label:_,radiusOffset:de,skipAngle:ie,skipRadius:ae,textColor:re,transitionMode:Je,component:le},"arcLabels")),Ne.length>0&&L.includes("legends")&&(hi.legends=S(X,{width:ti,height:ai,data:di,legends:Ne,toggleSerie:gi},"legends"));var bi=N({dataWithArc:oi,arcGenerator:li,centerX:si,centerY:ci,radius:ui,innerRadius:vi});return S(g,{width:_e,height:ei,margin:ii,defs:Li,role:Ze,children:L.map((function(e,i){return void 0!==hi[e]?hi[e]:"function"==typeof e?S(o,{children:r(e,bi)},i):null}))})},$=function(e){var i=e.isInteractive,t=void 0===i?Y.isInteractive:i,a=e.animate,n=void 0===a?Y.animate:a,r=e.motionConfig,o=void 0===r?Y.motionConfig:r,d=e.theme,l=e.renderWrapper,s=F(e,U);return S(u,{animate:n,isInteractive:t,motionConfig:o,renderWrapper:l,theme:d,children:S(Z,E({isInteractive:t},s))})},_=function(e){return S(L,{children:function(i){var t=i.width,a=i.height;return S($,E({width:t,height:a},e))}})},ee=["isInteractive","theme","renderWrapper"],ie=function(a){var n=a.data,o=a.id,d=void 0===o?Y.id:o,l=a.value,s=void 0===l?Y.value:l,c=a.valueFormat,u=a.sortByValue,f=void 0===u?Y.sortByValue:u,g=a.startAngle,L=void 0===g?Y.startAngle:g,A=a.endAngle,p=void 0===A?Y.endAngle:A,k=a.padAngle,R=void 0===k?Y.padAngle:k,I=a.fit,M=void 0===I?Y.fit:I,W=a.innerRadius,T=void 0===W?Y.innerRadius:W,D=a.cornerRadius,B=void 0===D?Y.cornerRadius:D,F=a.activeInnerRadiusOffset,H=void 0===F?Y.activeInnerRadiusOffset:F,X=a.activeOuterRadiusOffset,j=void 0===X?Y.activeOuterRadiusOffset:X,q=a.width,z=a.height,J=a.margin,N=a.pixelRatio,Q=void 0===N?Y.pixelRatio:N,U=a.colors,Z=void 0===U?Y.colors:U,$=a.borderWidth,_=void 0===$?Y.borderWidth:$,ee=a.borderColor,ie=void 0===ee?Y.borderColor:ee,te=a.enableArcLabels,ae=void 0===te?Y.enableArcLabels:te,ne=a.arcLabel,re=void 0===ne?Y.arcLabel:ne,oe=a.arcLabelsSkipAngle,de=void 0===oe?Y.arcLabelsSkipAngle:oe,le=a.arcLabelsTextColor,se=void 0===le?Y.arcLabelsTextColor:le,ce=a.arcLabelsRadiusOffset,ue=void 0===ce?Y.arcLabelsRadiusOffset:ce,ve=a.enableArcLinkLabels,fe=void 0===ve?Y.enableArcLinkLabels:ve,ge=a.arcLinkLabel,Le=void 0===ge?Y.arcLinkLabel:ge,he=a.arcLinkLabelsSkipAngle,be=void 0===he?Y.arcLinkLabelsSkipAngle:he,Ae=a.arcLinkLabelsOffset,pe=void 0===Ae?Y.arcLinkLabelsOffset:Ae,ke=a.arcLinkLabelsDiagonalLength,Re=void 0===ke?Y.arcLinkLabelsDiagonalLength:ke,Ie=a.arcLinkLabelsStraightLength,me=void 0===Ie?Y.arcLinkLabelsStraightLength:Ie,Oe=a.arcLinkLabelsThickness,Ce=void 0===Oe?Y.arcLinkLabelsThickness:Oe,xe=a.arcLinkLabelsTextOffset,we=void 0===xe?Y.arcLinkLabelsTextOffset:xe,Me=a.arcLinkLabelsTextColor,ye=void 0===Me?Y.arcLinkLabelsTextColor:Me,Se=a.arcLinkLabelsColor,We=void 0===Se?Y.arcLinkLabelsColor:Se,Te=a.isInteractive,De=void 0===Te?Y.isInteractive:Te,Ve=a.onClick,Be=a.onMouseMove,Ge=a.tooltip,Ee=void 0===Ge?Y.tooltip:Ge,Fe=a.activeId,He=a.onActiveIdChange,Xe=a.defaultActiveId,Ye=a.legends,je=void 0===Ye?Y.legends:Ye,Pe=a.forwardLegendData,qe=i(null),ze=h(),Je=v(q,z,J),Ke=Je.margin,Ne=Je.innerWidth,Qe=Je.innerHeight,Ue=Je.outerWidth,Ze=Je.outerHeight,$e=P({data:n,id:d,value:s,valueFormat:c,colors:Z}),_e=K({data:$e,width:Ne,height:Qe,fit:M,innerRadius:T,startAngle:L,endAngle:p,padAngle:R,sortByValue:f,cornerRadius:B,activeInnerRadiusOffset:H,activeOuterRadiusOffset:j,activeId:Fe,onActiveIdChange:He,defaultActiveId:Xe,forwardLegendData:Pe}),ei=_e.dataWithArc,ii=_e.arcGenerator,ti=_e.centerX,ai=_e.centerY,ni=_e.radius,ri=_e.innerRadius,oi=_e.setActiveId,di=V(ie,ze),li=m({data:ei,label:re,skipAngle:de,offset:ue,textColor:se}),si=O({data:ei,skipAngle:be,offset:pe,diagonalLength:Re,straightLength:me,label:Le,linkColor:We,textOffset:we,textColor:ye});t((function(){if(qe.current){qe.current.width=Ue*Q,qe.current.height=Ze*Q;var e=qe.current.getContext("2d");e.scale(Q,Q),e.fillStyle=ze.background,e.fillRect(0,0,Ue,Ze),e.save(),e.translate(Ke.left,Ke.top),ii.context(e),e.save(),e.translate(ti,ai),ei.forEach((function(i){e.beginPath(),e.fillStyle=i.color,e.strokeStyle=di(i),e.lineWidth=_,ii(i.arc),e.fill(),_>0&&e.stroke()})),!0===fe&&C(e,si,ze,Ce),!0===ae&&x(e,li,ze),e.restore(),je.forEach((function(i){y(e,E({},i,{data:ei,containerWidth:Ne,containerHeight:Qe,theme:ze}))}))}}),[qe,Ne,Qe,Ue,Ze,Ke.top,Ke.left,Q,ti,ai,ii,ei,_,di,ae,li,fe,si,Ce,je,ze]);var ci=e((function(){return ei.map((function(e){return E({id:e.id},e.arc)}))}),[ei]),ui=function(e){if(!qe.current)return null;var i=b(qe.current,e),t=i[0],a=i[1],n=w(Ke.left+ti,Ke.top+ai,ni,ri,ci,t,a);return n?ei.find((function(e){return e.id===n.id})):null},vi=G(),fi=vi.showTooltipFromEvent,gi=vi.hideTooltip,Li=function(e){var i=ui(e);i?(null==Be||Be(i,e),oi(i.id),fi(r(Ee,{datum:i}),e)):(oi(null),gi())};return S("canvas",{ref:qe,width:Ue*Q,height:Ze*Q,style:{width:Ue,height:Ze,cursor:De?"auto":"normal"},onMouseEnter:De?Li:void 0,onMouseMove:De?Li:void 0,onMouseLeave:De?function(){gi()}:void 0,onClick:De?function(e){if(Ve){var i=ui(e);i&&Ve(i,e)}}:void 0})},te=function(e){var i=e.isInteractive,t=void 0===i?Y.isInteractive:i,a=e.theme,n=e.renderWrapper,r=F(e,ee);return S(u,{isInteractive:t,renderWrapper:n,theme:a,children:S(ie,E({isInteractive:t},r))})},ae=function(e){return S(L,{children:function(i){var t=i.width,a=i.height;return S(te,E({width:t,height:a},e))}})};export{$ as Pie,te as PieCanvas,_ as ResponsivePie,ae as ResponsivePieCanvas,Y as defaultProps,P as useNormalizedData,J as usePie,q as usePieArcs,K as usePieFromBox,N as usePieLayerContext};
//# sourceMappingURL=nivo-pie.mjs.map
